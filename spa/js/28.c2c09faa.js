(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[28],{"20c0":function(e,a,t){},"23ff":function(e,a,t){"use strict";t("20c0")},a00b:function(e,a,t){"use strict";t.r(a);var i=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("q-page",[t("div",{staticClass:"absolute fit"},[t("base-scroll-area",[t("div",{staticClass:"constrain-more q-pa-md fit"},[t("div",{staticClass:"camera-frame q-pa-md bg-white"},[t("video",{directives:[{name:"show",rawName:"v-show",value:!e.imageCaptured,expression:"!imageCaptured"}],ref:"video",staticClass:"full-width",attrs:{autoplay:""}}),t("canvas",{directives:[{name:"show",rawName:"v-show",value:e.imageCaptured,expression:"imageCaptured"}],ref:"canvas",staticClass:"full-width",attrs:{height:"240"}})]),t("div",{staticClass:"text-center q-pa-md"},[e.hasCameraSupport&&e.cameraToggle?t("q-btn",{staticClass:"primary-gradient-background",attrs:{disable:e.imageCaptured,round:"",size:"lg",icon:"eva-camera"},on:{click:e.captureImage}}):t("q-file",{staticClass:"bg-white file-picker-field",attrs:{accept:"image/*",label:e.$t("chooseImage"),outlined:""},on:{input:e.captureImageFromFileUpload},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{name:"eva-attach-outline"}})]},proxy:!0}]),model:{value:e.imageUpload,callback:function(a){e.imageUpload=a},expression:"imageUpload"}})],1),t("div",{staticClass:"text-center q-ma-md"},[t("q-btn",{staticClass:"primary-gradient-background",attrs:{disable:!e.note.photo,label:e.$t("submitImage"),rounded:""},on:{click:e.submitImage}})],1),t("div",{staticClass:"row justify-center"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.note.photo,expression:"!note.photo"}],staticClass:"text-center"},[t("q-toggle",{attrs:{"checked-icon":"eva-camera",color:"green",size:"xl","unchecked-icon":"eva-attach"},on:{input:e.cameraToggledFalse},model:{value:e.cameraToggle,callback:function(a){e.cameraToggle=a},expression:"cameraToggle"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.hasCameraSupport&&e.cameraToggle&&!e.note.photo,expression:"hasCameraSupport && cameraToggle && !note.photo"}],staticClass:"text-center q-ml-md"},[t("q-toggle",{attrs:{"checked-icon":"eva-flip-2",color:"green",size:"xl","unchecked-icon":"eva-flip-2"},on:{input:e.toggleCameraFrontRear},model:{value:e.cameraRear,callback:function(a){e.cameraRear=a},expression:"cameraRear"}})],1)]),t("div",{staticClass:"fab-sticky-button"},[t("q-btn",{staticClass:"grey-gradient-background shadow-5 text-grey-8",attrs:{fab:"",icon:"eva-arrow-back"},on:{click:function(a){return e.$router.go(-1)}}})],1)])])],1)])},o=[],r=t("ded3"),n=t.n(r),s=(t("e260"),t("d3b7"),t("e6cf"),t("3ca3"),t("ddb0"),t("159b"),t("ac1f"),t("1276"),t("c19f"),t("ace4"),t("5cc6"),t("907a"),t("9a8c"),t("a975"),t("735e"),t("c1ac"),t("d139"),t("3a7b"),t("d5d6"),t("82f8"),t("e91f"),t("60bd"),t("5f96"),t("3280"),t("3fcc"),t("ca91"),t("25a1"),t("cd26"),t("3c5d"),t("2954"),t("649e"),t("219c"),t("170b"),t("b39a"),t("72f7"),t("2f62"));t("121f");var c={name:"PageCamera",components:{BaseScrollArea:function(){return Promise.all([t.e(0),t.e(18)]).then(t.bind(null,"1d71"))}},props:["_id"],data:function(){return{note:{_id:this._id,photo:null},imageUpload:[],imageCaptured:!1,hasCameraSupport:!0,cameraToggle:!0,cameraRear:!0,curSTREAM:null}},methods:n()(n()({},Object(s["b"])("notes",["addImage"])),{},{initCamera:function(){var e=this;null!==this.curSTREAM&&this.curSTREAM.getVideoTracks().forEach((function(e){e.stop()})),navigator.mediaDevices.getUserMedia({video:{facingMode:{exact:"environment"}}}).then((function(a){e.curSTREAM=a,e.$refs.video.srcObject=a})).catch((function(a){e.hasCameraSupport=!1}))},captureImage:function(){var e=this.$refs.video,a=this.$refs.canvas;a.width=e.getBoundingClientRect().width,a.height=e.getBoundingClientRect().height;var t=a.getContext("2d");t.drawImage(e,0,0,a.width,a.height),this.imageCaptured=!0,this.note.photo=this.dataURItoBlob(a.toDataURL()),this.disableCamera()},captureImageFromFileUpload:function(e){var a=this;this.note.photo=e;var t=this.$refs.canvas,i=t.getContext("2d"),o=new FileReader;o.onload=function(e){var o=new Image;o.onload=function(){t.width=o.width,t.height=o.height,i.drawImage(o,0,0),a.imageCaptured=!0},o.src=e.target.result},o.readAsDataURL(e)},disableCamera:function(){this.$refs.video.srcObject.getVideoTracks().forEach((function(e){e.stop()}))},dataURItoBlob:function(e){for(var a=atob(e.split(",")[1]),t=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(a.length),o=new Uint8Array(i),r=0;r<a.length;r++)o[r]=a.charCodeAt(r);var n=new Blob([i],{type:t});return n},cameraToggledFalse:function(e){e?(this.cameraRear=!0,this.initCamera()):this.disableCamera()},toggleCameraFrontRear:function(){var e=this;null!==this.curSTREAM&&this.curSTREAM.getVideoTracks().forEach((function(e){e.stop()})),this.cameraRear?navigator.mediaDevices.getUserMedia({video:{facingMode:{exact:"environment"}}}).then((function(a){e.curSTREAM=a,e.$refs.video.srcObject=a})):this.cameraRear||navigator.mediaDevices.getUserMedia({video:!0}).then((function(a){e.curSTREAM=a,e.$refs.video.srcObject=a})).catch((function(e){console.error(e)}))},submitImage:function(){var e=this;this.$q.loading.show(),this.addImage({_id:this._id,updates:this.note}),this.$router.push("/notes/".concat(this._id)),this.$q.loading.hide(),this.$q.platform.is.safari&&setTimeout((function(){window.location.href="/notes/".concat(e._id)}),1e3)}}),mounted:function(){this.initCamera()},beforeDestroy:function(){this.hasCameraSupport&&this.disableCamera()}},d=c,l=(t("23ff"),t("2877")),u=t("9989"),h=t("9c40"),m=t("7d53"),g=t("0016"),p=t("9564"),f=t("eebe"),v=t.n(f),b=Object(l["a"])(d,i,o,!1,null,null,null);a["default"]=b.exports;v()(b,"components",{QPage:u["a"],QBtn:h["a"],QFile:m["a"],QIcon:g["a"],QToggle:p["a"]})}}]);